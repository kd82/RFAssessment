@{
   ViewBag.Title = "Home Page";
}

@{
   Layout = null;
}
<div class="row">&nbsp;</div>
<div style="margin: 0 auto; width: 90%;">
   <table id="customerTable" class="table table-striped table-bordered" style="width: 100%">
      <thead>
      <tr>
         <th>Company Name</th>
         <th>Years in Business</th>
         <th>Contact Name</th>
         <th>Contact Phone</th>
         <th>Contact Email</th>
      </tr>
      </thead>
   </table>
</div>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<link href="~/Content/bootstrap.css" rel="stylesheet"/>
<link href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.datatables.net/responsive/2.1.1/css/responsive.bootstrap.min.css" rel="stylesheet"/>
<script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap4.min.js "></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
<script>
   $(document).ready(function() {
      $('#customerTable').DataTable({
         dom: 'Bfrtip',
         buttons: [
            {
               extend: 'csv',
               text: 'Export to CSV',
               title: 'Customers'
            },
            {
               extend: 'excel',
               text: 'Export to Excel',
               title: 'Customers'
            }
         ],
         "ajax": {
            "url": "/Home/LoadData",
            "type": "GET",
            "datatype": "json",
            error: function(errorThrown) {
               console.log(errorThrown);
            }
         },
         "columns": [
            { "data": "Result.CompanyName", "name": "Result.CompanyName", "autoWidth": true },
            { "data": "Result.YearsInBusiness", "name": "Result.YearsInBusiness", "autoWidth": true},
            { "data": "Result.ContactFirstName", "name": "Result.ContactName", "autoWidth": true },
            { "data": "Result.ContactPhone", "name": "Result.ContactPhone", "autoWidth": true },
            { "data": "Result.ContactEmail", "name": "Result.ContactEmail", "autoWidth": true }
         ],
         columnDefs: [
            { targets: [1], orderData:[1,0]}
         ]
      });
   });
</script>